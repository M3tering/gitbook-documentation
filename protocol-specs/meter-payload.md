# Meter Payload

The protocol’s core data unit is a JSON payload, transmitted from smart meters. Each payload contains energy consumption data along with cryptographic elements to ensure authenticity and is structured as follows:

* **Data**: A stringified array containing:
  * `nonce`: A unique message identifier.
  * `voltage`: The voltage reading from the smart meter.
  * `current`: The current reading from the smart meter.
  * `energy`: The computed energy based on voltage and current readings.
* **Signature**: A string of characters equivalent to the cryptographic signature of the above data, encoded in Base64 format., generated by the smart meter hardware.
* **Public Key**: The public key of the signing entity, which in this case, is the  smart meter hardware. Also encoded in Base64 format.

#### **Example Payload**

```json
{
  "payload": [
    "[2, 213.7, 0.38, 0.007420]",
    "9C7lPdznR9pymAIvjDPmm/mVX/uUTemapJRb8yzGKvG8or43u6V97oDPcW7ZP9HeHRZrGEf1iIkyLixAVdWsDg==",
    "JR2VNczJacY86eyyCBr1iTTT7vxKtYbfqegeTkXJD88="
  ]
}
```

In this example:

* The signed message string is `"[2, 213.7, 0.38, 0.007420]"`, where 2 is the nonce, 213.7 is the voltage, 0.38 is the current, and 0.007420 is the computed energy.
* The signature and public key fields are Base64-encoded strings representing signature and public key, respectively.

{% hint style="info" %}
The signature and public key within the payload are encoded using Base64. This encoding allows binary data to be easily represented as ASCII text, simplifying transmission across systems that may be resource constrained such as microprocessors in the smart metering hardware, and communication networks such as LoRaWAN.
{% endhint %}

## Signature Scheme

To ensure data integrity and authenticity, the M3tering Protocol employs the Ed25519 digital signature scheme. This scheme is a well-regarded cryptographic method known for its high performance and strong security guarantees. Each payload is signed by the meter’s private key, which, in conjunction with the associated public key, ensures that data can be verified and trusted by external systems or entities receiving it.

* **Simplicity**: Ed25519 is simpler and easier to implement than ECDSA, which is a considerable benefit for IoT devices with limited resources.
* **Performance**: Ed25519 provides faster signature generation and verification, which is crucial for IoT devices operating in real-time environments. The reduced computational load can lead to significant power savings and memory efficiency, which can significantly improve the overall performance of our devices and the M3tering Protocol as a whole.
* **Compatibility**: While secp256k1 is widely used in the blockchain space, curve25519 is gaining traction due to its compatibility with various platforms and libraries. This compatibility simplifies integration efforts and ensures a seamless experience for developers working with our devices.
* **Compact Signatures**: Ed25519 generates smaller signature sizes, which is crucial for IoT devices with constrained data transmission capabilities. The efficiency gains could lead to reduced transmission times and enhanced device responsiveness.
* **Long-term Viability**: It's designed with long-term security in mind, making it a reliable choice for the future.

{% hint style="info" %}
you can learn more about ED25519 and other comparable schemes [here](https://soatok.blog/2022/05/19/guidance-for-choosing-an-elliptic-curve-signature-algorithm-in-2022/)\
The blog also provides a rational for our adoption of the ED25519 signature scheme.
{% endhint %}

## Verification

The M3ter NFT contract on the EVM also serve as a key registry for each hardware smart meter. During the initial setup, each hardware meter generates its own ED25519 key pair and it posts the public key to this M3ter contract in a registration event, binding it to a specific tokenId that represents this particular hardware device. To authenticate any subsistent data from the smart meter, the public key stored in the M3ter contract can be used to verify the digital signature attached to the payload.&#x20;

This setup provides a secure and tamper-resistant method for linking each data point to its specific device, ensuring the integrity and traceability of the data stream from the physical meter to its digital representation as an NFT on-chain.&#x20;

<figure><img src="../.gitbook/assets/Screenshot 2024-11-10 at 08-41-51 M3tering Protocol Data Format - Presentation - Canva.png" alt=""><figcaption></figcaption></figure>
